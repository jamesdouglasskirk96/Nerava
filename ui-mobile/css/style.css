:root{
  --navy:#0c1c2a;
  --panel:#0f2335;
  --text:#e7eef6;
  --muted:#b8c6d4;
  --green:#79d98c;
  --pill:#173247;
  --shadow: 0 10px 30px rgba(0,0,0,.35);
}

/* SSO Overlay Styles */
.sso-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 12px 16px;
  margin: 8px 0;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  background: #fff;
  color: #1e293b;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}
.sso-btn:hover { background: #f8fafc; border-color: #cbd5e1; }
.sso-btn.btn-apple { background: #000; color: #fff; border-color: #000; }
.sso-btn.btn-google { background: #4285f4; color: #fff; border-color: #4285f4; }
.sso-row { display: flex; flex-direction: column; gap: 4px; }

/* Demo Push Banner */
.demo-push {
  position: fixed;
  bottom: 100px;
  left: 16px;
  right: 16px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 12px 16px;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  z-index: 1000;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  animation: slideUp 0.3s ease-out;
}
@keyframes slideUp {
  from { transform: translateY(100px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

*{box-sizing:border-box}
html,body,#app{height:100%;margin:0}
body{
font-family: -apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
-webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
background:var(--bg);color:var(--text);
}

#map{position:absolute; inset:0; z-index:1; min-height:100%}
.ui-layer{position:relative; z-index:2}

.full-height{ height: calc(100vh - 56px - 36px); }

/* Top */
.app-top{position:fixed; top:0; left:0; right:0; z-index:3}
.brandbar{display:flex; align-items:center; justify-content:center; gap:.75rem; height:56px; background:var(--surface); border-bottom:1px solid rgba(0,0,0,.06)}
.brand-word{letter-spacing:.35rem;font-weight:800}
.brand-bolt{width:20px;height:20px;filter:invert(1)}
.deal-banner{background:var(--green); color:#0b1a26; font-weight:800; text-align:center; padding:.6rem 1rem}

.main-layer{padding-top:108px; padding-bottom:100px}

/* Pages */
.page{display:none}
.page.active{display:block}

/* Cards */
.card{background:var(--surface); color:var(--text); border-radius:28px; box-shadow: 0 10px 30px rgba(2, 8, 20, .06); padding:22px}
.hub-card{width:92%; margin:0 auto; position:fixed; left:50%; transform:translateX(-50%); bottom:88px}
.content-card{width:92%; margin:100px auto 0}

/* Hub */
.hub-name{font-size:32px; line-height:1.1; margin:0 0 .25rem}
.hub-subtitle{color:var(--muted); font-weight:800; margin-bottom:.75rem}

.pill-row{display:flex; gap:.6rem; margin-bottom:.8rem}
.pill{background:var(--pill); color:var(--text); padding:.4rem .7rem; border-radius:18px; font-weight:700; font-size:.9rem}

.logo-row{display:flex; gap:.7rem; margin:.4rem 0 1rem}
.merchant-logo{width:48px;height:48px;border-radius:50%;object-fit:cover;display:block;box-shadow:0 2px 8px rgba(0,0,0,.35)}

.meta-line{display:flex; gap:.5rem; align-items:center; color:var(--muted); margin-bottom:1rem}
.dot{opacity:.6}

/* Buttons */
.btn{border:0; cursor:pointer; font-weight:800; border-radius:18px}
.btn-primary{background:var(--green); color:#0a1a26; padding:1rem 1.2rem}
.btn-wide{width:100%}
.pill-btn{background:#102e41; color:var(--text); padding:.7rem 1rem}

/* Charge/Wallet/Profile */
.section-title{margin:0 0 .5rem; font-size:28px}
.balance{font-size:36px; font-weight:900; margin:.25rem 0 .75rem}
.list{list-style:none; padding:0; margin:.75rem 0 0}
.list li{display:flex; justify-content:space-between; padding:.6rem 0; border-bottom:1px solid rgba(255,255,255,.06)}
.row{display:flex}
.gap{gap:.75rem}
.muted{color:var(--muted)}
.prefs{display:grid; grid-template-columns:1fr 1fr; gap:.5rem 1rem; margin:.5rem 0 1rem}

/* Bottom Nav */
.bottom-nav{position:fixed; left:0; right:0; bottom:0; height:72px; display:flex; justify-content:space-around; align-items:center; background:var(--nav-bg); backdrop-filter: saturate(180%) blur(10px); z-index:3; border-top:1px solid rgba(0,0,0,.06)}
.bottom-nav .tab{background:transparent; border:0; color:var(--nav-label); display:flex; flex-direction:column; gap:.25rem; align-items:center; font-weight:700}
.bottom-nav .tab.active{color:var(--nav-label-active); font-weight:800}
.bottom-nav img{width:22px;height:22px;color:var(--nav-icon); filter: none; opacity: 0.95;}
.bottom-nav .tab.active img{color:var(--nav-icon-active); opacity: 1;}

.card{background:var(--card); border:1px solid #e2e8f0; border-radius:var(--radius-2); padding:var(--space-4); box-shadow:var(--shadow-1);}
.grid{display:grid; gap:16px; grid-template-columns:1fr; }
@media(min-width:980px){ .grid{grid-template-columns:1fr 1fr 1fr;} }
.text-quiet{color:var(--text-quiet)}
.h2{font-size:18px; font-weight:700; margin:0 0 8px}
.h3{font-size:16px; font-weight:700; margin:0 0 6px}

/* Walking Route Styles */
.route-badge{
  position:absolute;
  left:16px;
  top:12px;
  background:#fff;
  border-radius:12px;
  padding:6px 10px;
  font-weight:700;
  box-shadow:0 4px 16px rgba(0,0,0,.12);
}

.walk-cta{
  position:relative;
  margin:8px 16px 0;
  padding:10px 12px;
  border-radius:12px;
  background:color-mix(in srgb, var(--brand) 14%, #fff);
  font-weight:600;
}

.walk-cta button{
  background:var(--brand);
  color:#fff;
  border:0;
  border-radius:10px;
  padding:8px 12px;
  margin-left:8px;
}

/* Deprecate QR scanning UI (kept in DOM for safety, hidden visually) */
/* Removed scan panel styles */

/* Charge tab: simple verify-by-location button */
.verify-card{
  margin:16px; padding:16px; border-radius:14px;
  background:#fff; box-shadow:0 6px 20px rgba(0,0,0,.08);
}

.verify-card h3{ margin:0 0 8px; font-size:16px; }

.verify-btn{
  display:inline-block; background:var(--brand); color:#fff;
  border:0; border-radius:10px; padding:10px 14px; font-weight:700;
}

/* Safe-area spacing for tab bar & Leaflet attribution */
.leaflet-control-attribution, .leaflet-bottom { 
  margin-bottom: calc(var(--tabbar-height, 72px) + env(safe-area-inset-bottom, 0px)); 
}

/* Map container styling */
#map, .map-shell { 
  border-radius: 18px; 
  overflow: hidden; 
}

/* Header */
.topbar{
  height:64px; display:flex; align-items:center; justify-content:center;
  background:#fff; position:sticky; top:0; z-index:20;
  box-shadow:0 2px 8px rgba(0,0,0,.05);
}
.brand-logo{
  font-weight:700; letter-spacing:.04em; font-size:20px;
  color: var(--brand-blue);
}
.brand-logo .bolt{ color:#F5B400 }

/* Tabbar */
.tabbar{
  position:fixed; left:0; right:0; bottom:0; height:var(--tabbar-height);
  display:flex; align-items:center; justify-content:space-around;
  padding: 8px 12px calc(env(safe-area-inset-bottom,0px) + 8px);
  background:rgba(255,255,255,.85); backdrop-filter: blur(10px);
  box-shadow:0 -8px 20px rgba(0,0,0,.12); z-index:30;
  border-radius: 20px 20px 0 0;
}
.tab{
  flex:1; display:flex; flex-direction:column; align-items:center; gap:6px;
  min-width:48px; color: #A0A3B1; text-decoration:none;
  padding: 8px; /* Ensure 48px minimum tap area */
}
.tab .icon{
  width:24px; height:24px; stroke: currentColor; fill:none; stroke-width:1.5;
}
.tab .label{ font-size:12px; color:#A0A3B1; font-weight:500; }
.tab.active{ color: var(--brand-blue); }
.tab.active .label{ color: var(--brand-blue); font-weight:600; }

/* Centered Earn pill - aligned with nav icons */
.earn-pill{
  position:absolute; bottom: calc(env(safe-area-inset-bottom,0px) + var(--tabbar-height) - 36px);
  left:50%; transform: translateX(-50%);
  background: var(--brand-blue); color:#fff; width:56px; height:56px;
  border-radius:18px; display:flex; align-items:center; justify-content:center; flex-direction:column;
  box-shadow:0 4px 12px rgba(47,111,224,0.15);
  z-index:31; pointer-events:auto;
}
.earn-pill .icon{ width:20px; height:20px; color:#fff; stroke-width:1.5; }
.earn-pill .label{ color:#fff; font-weight:600; margin-top:2px; font-size:10px; }

/* Earn button outline matches nav icon color */
.tabbar .tab--primary {
  border: 2px solid var(--nav-icon) !important; /* same as inactive icon color */
  box-shadow: 0 10px 28px rgba(0,0,0,0.18);
}

/* Hide Leaflet attribution permanently */
.leaflet-control-attribution,
.leaflet-bottom.leaflet-right {
  display: none !important;
}

/* Ensure tab items distribute evenly with space-around */
.tabbar-inner{
  position:relative; width:100%; height:100%;
  display:flex; align-items:center; justify-content:space-around;
  gap:0;
}
.tabbar .tab{ flex: 0 0 auto; }


/* Enhanced Explore page styling */
.mini-sheet__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.perk-reward {
  font-size: 14px;
  color: var(--brand);
  font-weight: 600;
  margin-top: 4px;
}

.perk-actions {
  margin-top: 12px;
  display: flex;
  gap: 8px;
}

.btn-secondary {
  background: #f5f5f5;
  color: #666;
  border: 1px solid #e0e0e0;
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-secondary:hover {
  background: #e8e8e8;
}

/* Route badge styling */
.route-badge {
  position: absolute;
  top: 16px;
  left: 16px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  padding: 8px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  color: #666;
  z-index: 1000;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* AI badge styling */
.ai-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  background: var(--brand);
  color: #fff;
  padding: 4px 8px;
  border-radius: 12px;
  font-weight: 700;
  font-size: 10px;
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.3);
  white-space: nowrap;
}

/* --- Explore polish --- */
.route-badge{
  position:absolute; left:18px; top:18px; z-index:400;
  background: var(--brand); color:#fff; font-weight:700;
  padding:8px 12px; border-radius:999px; box-shadow:0 8px 24px rgba(0,0,0,.12);
  display:flex; align-items:center; gap:8px;
}
.route-badge.hidden{ display:none; }
.route-badge .bolt{ width:14px; height:14px; display:inline-block; }

.perk-card{
  margin:16px 18px 8px; padding:14px; border-radius:16px;
  background:#fff; box-shadow:0 10px 24px rgba(0,0,0,.07);
}
.perk-card.hidden{ display:none; }
.perk-card .row{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
.perk-card .meta{ color:#667085; font-size:13px; margin-top:6px; }
.perk-card .brand{ display:flex; align-items:center; gap:10px; }
.perk-card .brand img{ width:36px; height:36px; border-radius:10px; object-fit:cover; }
.perk-card .ai-badge{
  display:inline-flex; align-items:center; gap:6px; margin-left:8px;
  background: var(--brand); color:#fff; padding:4px 10px; border-radius:999px; font-weight:700; font-size:12px;
}

.view-more{ padding:8px 18px 18px; }
.btn-secondary{
  width:100%; padding:12px 14px; border-radius:12px;
  background:#f3f4f6; border:1px solid #e5e7eb; color:#111827; font-weight:600;
}

/* Merchant logo marker */
.leaflet-div-icon.merchant-logo{
  background:#fff; border:2px solid var(--brand); border-radius:14px; box-shadow:0 6px 16px rgba(0,0,0,.16);
  width:44px; height:44px; display:flex; align-items:center; justify-content:center;
}
.leaflet-div-icon.merchant-logo img{ width:34px; height:34px; border-radius:8px; object-fit:cover; }

/* Ensure #map stays clipped nicely */
#map{ border-radius:20px; overflow:hidden; }

/* Map card */
.map-card{
  margin:16px; border-radius:18px; overflow:hidden;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
  background:#fff;
}
#map{ width:100%; height:340px; }
.leaflet-control-attribution{
  margin-bottom: calc( env(safe-area-inset-bottom, 0px) + var(--tabbar-height) + 8px ) !important;
}
.map{width:100%;height:320px}
.route-badge{position:absolute;left:12px;top:12px;display:flex;align-items:center;gap:6px;background:rgba(0,0,0,.64);color:#fff;padding:8px 12px;border-radius:999px;font-weight:600}
.route-badge .bolt{color:#ffd54a}
.hidden{display:none!important}

/* Section title */
.section-title { margin: 20px 0 10px; color: var(--ink-700); font-weight:700; opacity:.5; }
.perk-card{display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center;background:var(--card);border-radius:16px;padding:12px 14px;box-shadow:0 8px 24px rgba(16,24,40,.12)}
.perk-logo{width:48px;height:48px;border-radius:12px;background:#eef3ff;display:grid;place-items:center;font-size:24px}
.ai-chip{display:inline-flex;align-items:center;gap:6px;background:var(--brand);color:white;padding:4px 8px;border-radius:999px;font-size:12px;font-weight:700;margin-bottom:6px}
.perk-meta,.perk-dist{color:var(--muted);font-size:13px;margin:2px 0}
/* ---------- Primary Buttons (incl. Claim) ---------- */
.btn, .btn-primary{
  background: var(--brand); color: var(--brand-ink-contrast);
  border: none; border-radius: 999px; padding: 12px 18px; font-weight:700;
  box-shadow: 0 10px 22px color-mix(in srgb, var(--brand) 25%, transparent);
}
.btn:active{ transform: scale(.98) }
.btn-primary{background:var(--brand);color:var(--brand-ink-contrast);border:0;border-radius:12px;padding:10px 12px;font-weight:800}
.btn-secondary{background:#eef2f7;color:#0b1220;border:0;border-radius:12px;padding:10px 12px;font-weight:700}
.view-more{display:flex;justify-content:center;margin:16px 0 4px}

/* ---------- Tabbar (same height, bigger icons) ---------- */
.tabbar{
  position: sticky; bottom:0; z-index: 30;
  height: var(--tabbar-height); display:flex; align-items:center; justify-content:space-around;
  backdrop-filter: blur(10px);
  background: rgba(255,255,255,.85); border-top: 1px solid rgba(0,0,0,.06);
}
.tab{
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:6px; width:20%; height:100%;
}
.tab .icon{ font-size: 28px; line-height: 1; color:#a0a6b2 }       /* light grey */
.tab .label{ font-size:14px; color:#6c7280 }
.tab.active .icon, .tab.active .label{ color: var(--brand) }

/* Raised Claim button stays same size; color now brand */
.tab.claim .pill{
  height:54px; width:96px; border-radius: 28px; background:#000; /* keep black pill per your look */
  display:flex; align-items:center; justify-content:center;
}
.tab.claim .icon{ color:#fff } /* claim icon white on black pill */
.tab-primary{align-self:center;justify-self:center;background:var(--brand);color:var(--brand-ink-contrast);border-radius:22px;padding:10px 18px;font-weight:800;transform:translateY(-10px)}

/* Leaflet attribution safe area */
.leaflet-control-attribution{ margin-bottom: calc(env(safe-area-inset-bottom, 0px) + 8px); }
