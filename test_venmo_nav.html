<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nerava - Venmo-Style Navigation Test</title>
    <link rel="stylesheet" href="ui-mobile/css/tokens.css">
    <link rel="stylesheet" href="ui-mobile/css/animations.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <div id="app" class="app-root">
        <!-- Header -->
        <header class="app-header" role="banner" aria-label="Nerava">
            <div class="header-center">
                <span class="brand">NERAVA</span>
                <span class="bolt" aria-hidden="true">âš¡</span>
            </div>
        </header>

        <!-- Map is global and behind -->
        <div id="map" role="img" aria-label="Map"></div>

        <!-- Explore page: sheet over map -->
        <section id="pageExplore" class="page active">
            <div class="sheet" id="exploreSheet">
                <div class="sheet__header">
                    <div class="sheet-handle"></div>
                    <h2 style="margin:0;">Explore</h2>
                </div>

                <div class="sheet__body sheet-explore">
                    <!-- Incentive banner lives inside the sheet now -->
                    <div id="incentive-banner" class="badge" style="display:none;align-self:center;"></div>

                    <!-- Hub card (example) -->
                    <div class="card" id="hubCard">
                        <h3 style="margin:0 0 8px 0; font-size:20px;">Nerava Hub</h3>
                        <div style="display:flex; gap:8px; margin-bottom:10px;">
                            <span class="badge" id="hubAvail">3 of 4 ports free</span>
                            <span class="badge" id="hubDeal">10% cheaper</span>
                        </div>
                        <button id="chargeHereBtn" class="btn btn-primary" style="width:100%;">Start Charging</button>
                    </div>

                    <!-- Nearby places (Apple-style list container) -->
                    <div class="card">
                        <h4 style="margin:0 0 10px 0;">Nearby Places</h4>
                        <div id="nearbyList" class="place-grid">
                            <!-- JS fills in demo tiles; keep markup minimal -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Charge / Wallet / Me now padded pages (not overlay sheets) -->
        <section id="pageCharge" class="page page-padded">
            <div id="chargePane" class="pane">
                <div class="card" id="chargeStatusCard" style="margin:12px;">
                    <h3>Charging activity</h3>

                    <!-- Cumulative kWh total -->
                    <div id="cumulativeKwh" style="margin:8px 0; padding:10px; border:1px solid #e5e7eb; border-radius:12px; background:#f9fafb;">
                        <div><strong>Total charged:</strong> <span id="totalKwh">0.0</span> kWh</div>
                    </div>

                    <!-- Live window / reward preview -->
                    <div id="rewardPreview" style="display:none; margin:8px 0; padding:10px; border-radius:12px; background:#0B2A4A; color:#fff;">
                        <div id="rewardPreviewText" style="font-weight:600;"></div>
                        <div id="rewardPreviewSub" style="opacity:0.85; font-size:0.9em;"></div>
                    </div>

                    <!-- Active session status -->
                    <div id="activeSession" style="display:none; margin:8px 0; padding:10px; border:1px solid #e5e7eb; border-radius:12px;">
                        <div><strong>Session:</strong> <span id="sessionIdShort"></span></div>
                        <div><strong>Started:</strong> <span id="sessionStart"></span></div>
                        <div><strong>Elapsed:</strong> <span id="sessionElapsed"></span></div>
                    </div>

                    <!-- Controls -->
                    <div id="chargeControls" style="margin-top:10px; display:flex; gap:8px;">
                        <button id="btnStartCharge" class="btn btn-primary" style="flex:1;">Start charging</button>
                        <button id="btnStopCharge" class="btn btn-secondary" style="flex:1;" disabled>Stop & credit</button>
                    </div>

                    <!-- kWh prompt (shown on stop) -->
                    <dialog id="kwhDialog" style="z-index:3000;">
                        <form method="dialog" style="min-width:260px;">
                            <h4>How many kWh did you add?</h4>
                            <input id="kwhInput" type="number" min="0.1" step="0.1" placeholder="e.g. 18.6" required style="width:100%; padding:8px; margin:8px 0;">
                            <menu style="display:flex; gap:8px; justify-content:flex-end;">
                                <button data-return="cancel">Cancel</button>
                                <button data-return="confirm">Confirm</button>
                            </menu>
                        </form>
                    </dialog>
                </div>

                <!-- Community Activity (Venmo-style) -->
                <section id="communityActivity" class="card" style="margin:12px;">
                    <div class="card-header">
                        <h3>Community Activity</h3>
                        <div class="seg">
                            <button id="feedAllBtn" class="seg-btn active">All</button>
                            <button id="feedFollowingBtn" class="seg-btn">Following</button>
                        </div>
                    </div>
                    <ul id="activityFeed" class="feed-list">
                        <!-- items injected -->
                    </ul>
                </section>

                <!-- Leaderboard -->
                <section id="leaderboard" class="card" style="margin:12px;">
                    <h3>Weekly Leaders</h3>
                    <div id="leaderboardList" class="leaderboard-list">
                        <!-- items injected -->
                    </div>
                </section>
            </div>
        </section>

        <section id="pageWallet" class="page page-padded">
            <section class="card content-card">
                <h2 class="section-title">Wallet</h2>
                <div class="balance" id="wallet-balance">$19.00</div>
                <div class="muted">Ways you earned</div>
                
                <!-- Progress bar toward next tier -->
                <div class="wallet-progress" style="margin:8px 0 12px;">
                    <div class="bar" style="width:0"></div>
                    <div class="progress-text">$6 more to reach Gold tier</div>
                </div>
                
                <!-- Streak indicator -->
                <div class="streak-indicator" style="margin: 8px 0; padding: 8px; background: var(--color-orange); border-radius: var(--radius); text-align: center;">
                    <span class="streak-text">7-day charging streak ðŸ”¥</span>
                </div>

                <!-- Quick Actions -->
                <div class="wallet-actions" style="margin: 16px 0; display: flex; gap: 8px;">
                    <button class="btn btn-secondary" style="flex: 1;">Add Funds</button>
                    <button class="btn btn-secondary" style="flex: 1;">Withdraw</button>
                </div>
                
                <ul class="list" id="wallet-activity">
                    <li><span>You saved $3.73 during Green Hour ðŸŒž</span><strong>+$3.73</strong></li>
                    <li><span>Earned $0.75 from Starbucks co-fund â˜•</span><strong>+$0.75</strong></li>
                    <li><span>Off-peak award</span><strong>+$0.50</strong></li>
                </ul>
            </section>
        </section>

        <section id="pageClaim" class="page page-padded">
            <div class="card">
                <h3>Claim Rewards</h3>
                <div id="claimMap" style="height: 200px; background: #f0f0f0; border-radius: 12px; margin: 12px 0;"></div>
                <div id="claimStatus" class="claim-status">Move closer to the charger to claim rewards</div>
                <div id="incentivesList" class="incentives-list">
                    <!-- Dynamic incentives will be populated here -->
                </div>
            </div>
        </section>

        <section id="pageMe" class="page page-padded">
            <section class="card content-card">
                <h2 class="section-title">Profile</h2>
                <p class="muted">Signed in as demo@nerava.app</p>
                
                <!-- Profile Stats -->
                <div class="profile-stats" style="margin: 16px 0; display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                    <div class="stat-card" style="padding: 12px; background: var(--surface); border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--brand);">47</div>
                        <div style="font-size: 12px; color: var(--muted);">Total Sessions</div>
                    </div>
                    <div class="stat-card" style="padding: 12px; background: var(--surface); border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--brand);">1,247</div>
                        <div style="font-size: 12px; color: var(--muted);">kWh Charged</div>
                    </div>
                </div>

                <!-- Preferences -->
                <h3 style="margin: 16px 0 8px 0; font-size: 16px;">Preferences</h3>
                <div class="prefs">
                    <label><input type="checkbox" checked> Coffee & Bakery</label>
                    <label><input type="checkbox" checked> Quick Bites</label>
                    <label><input type="checkbox"> Dog Friendly</label>
                    <label><input type="checkbox"> Kid Friendly</label>
                    <label><input type="checkbox"> Shopping</label>
                </div>

                <!-- Actions -->
                <div class="profile-actions" style="margin: 16px 0;">
                    <button class="btn btn-secondary" style="width: 100%; margin-bottom: 8px;">My QR Code</button>
                    <button class="btn btn-secondary" style="width: 100%; margin-bottom: 8px;">Notification Settings</button>
                    <button class="btn btn-secondary" style="width: 100%; margin-bottom: 8px;">Privacy Settings</button>
                    <button class="btn" style="width: 100%; color: var(--danger);">Sign out</button>
                </div>
            </section>
        </section>

    </div>

    <!-- Venmo-style 5-Tab Navigation -->
    <nav id="bottom-nav" class="bottom-nav" role="tablist" aria-label="Primary">
        <button id="tabExplore" class="tab" role="tab" aria-selected="true" aria-controls="pageExplore"><span class="icon i-explore"></span><span>Explore</span></button>
        <button id="tabCharge"  class="tab" role="tab" aria-controls="pageCharge"><span class="icon i-charge"></span><span>Charge</span></button>
        <button id="tabClaim"   class="tab tab-center" role="tab" aria-controls="pageClaim" aria-label="Claim"><span class="icon i-claim"></span></button>
        <button id="tabWallet"  class="tab" role="tab" aria-controls="pageWallet"><span class="icon i-wallet"></span><span>Wallet</span></button>
        <button id="tabMe"      class="tab" role="tab" aria-controls="pageMe"><img class="avatar-icon" src="/app/img/avatar-demo.svg" alt="" /><span>Me</span></button>
    </nav>

    <script src="ui-mobile/js/animations.js"></script>
    <script src="ui-mobile/js/app.js?v=10" defer></script>
</body>
</html>
